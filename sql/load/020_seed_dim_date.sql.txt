INSERT INTO dim_date (date_key, year, month, day, week_of_year, day_of_week)
SELECT
  d::date AS date_key,
  EXTRACT(YEAR FROM d)::int AS year,
  EXTRACT(MONTH FROM d)::int AS month,
  EXTRACT(DAY FROM d)::int AS day,
  EXTRACT(WEEK FROM d)::int AS week_of_year,
  EXTRACT(ISODOW FROM d)::int AS day_of_week
FROM generate_series(
  (SELECT MIN(date) FROM staging_google_ads),
  (SELECT MAX(date) FROM staging_google_ads),
  interval '1 day'
) AS d
ON CONFLICT (date_key) DO NOTHING;
